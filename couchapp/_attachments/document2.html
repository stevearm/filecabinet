<!DOCTYPE html>
<html lang="en" ng-app="filecabinet">
    <head>
        <meta charset="utf-8" />
        <title>File Cabinet</title>
        <link rel="stylesheet" type="text/css" href="style/main.css"/>
        <style type="text/css">
#properties {
    width: 400px;
    display: inline-block;
    vertical-align: top;
}
#thumbnail {
    width: 400px;
    display: inline-block;
}
#full-image-viewport {
    height: 400px;
    width: 400px;
    overflow: hidden;
    border: solid thin black;
}
#full-image {
    position: relative;
    cursor: move;
}
        </style>
    </head>
    <body ng-controller="DocumentCtrl">
        <div style="float: right">
            <a href="index.html">All docs</a> |
            <a href="unseen.html">Unseen</a>
        </div>
        <div id="properties">
            <div>
                <span class="key">Filename</span>
                <span id="filename" class="value"></span>
            </div>
            <div>
                <span class="key">Uploaded</span>
                <span id="uploaded" class="value"></span>
            </div>
            <div>
                <span class="key">Effective</span>
                <span class="value"><input type="text" id="effective-date" size="20"/></span>
            </div>
            <div>
                <span class="key">Tags</span>
                <span class="value"><input name="tags" id="tags" style="position:relative" value=""/></span>
            </div>
            <div>
                <span class="key">Seen</span>
                <span class="value"><button onclick="doc.unseen = true; save();">Mark unseen</button></span>
            </div>
            <div>
                <span class="key">Original</span>
                <span class="value"><a id="download" href="" target="_blank">Download</a></span>
            </div>
        </div>
        <div id="thumbnail">
            <div id="thumb-select" style="display: none">
                Current: <input type="text" disabled="true" id="thumb-current"/>
            </div>
            <div id="full-image-viewport">
                <img id="full-image" ng-src="{{ imgSrc }}" draggable/>
            </div>
        </div>

        <script src="angular/angular.min.js"></script>
        <script src="angular/angular-resource.min.js"></script>
        <script type="text/javascript">
var mytmp = null;
angular.module("filecabinet", ["ngResource"])

.controller("DocumentCtrl", ["$scope", "$http", "$location", function($scope, $http, $location) {
    console.log($location.path);

    $scope.imgSrc = "/filecabinet/e2a382b948cff09c5ef3b5cf4d13201c/thumb/pdf_view";
}])

.directive('draggable', function($document) {
    return function(scope, element, attr) {
        var startX = 0, startY = 0, x = 0, y = 0;
        element.css({
            position: 'relative',
            border: '1px solid red',
            backgroundColor: 'lightgrey',
            cursor: 'pointer'
        });
        element.on('mousedown', function(event) {
            // Prevent default dragging of selected content
            event.preventDefault();
            startX = event.screenX - x;
            startY = event.screenY - y;
            $document.on('mousemove', mousemove);
            $document.on('mouseup', mouseup);
        });

        function mousemove(event) {
            y = event.screenY - startY;
            if (y > 0) { y = 0; }

            x = event.screenX - startX;
            if (x > 0) { x = 0; }

            element.css({
                top: y + 'px',
                left:  x + 'px'
            });
        }

        function mouseup() {
            $document.unbind('mousemove', mousemove);
            $document.unbind('mouseup', mouseup);
        }
    }
});
        </script>
    </body>
</html>